name: RawTherapee
buildsystem: cmake-ninja
builddir: true
config-opts:
  - -DCMAKE_BUILD_TYPE=RelWithDebInfo
sources:
  - type: archive
    url: https://github.com/Beep6581/RawTherapee/archive/5.6.tar.gz
    sha256: bd1d1a8cee698dc8a4129c5f671ba507511ac3cdfe8346c5cf76fc7dc286dcfd
  # https://github.com/Beep6581/RawTherapee/pull/5304
  # https://github.com/Beep6581/RawTherapee/commit/ef722d37cbd6a64eef1279cf9c7b3b0988100d1c#diff-ff2bf1aeefe12aeab6da2531ed8d9127
  # https://github.com/Beep6581/RawTherapee/pull/5460
  - type: patch
    path: RawTherapee-5.6-xdg.patch
post-install:
  - xmlstarlet ed --inplace -d "/component/provides/binary[text()='rawtherapee-cli']" "${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.appdata.xml";
  - install -p -D -m 0644 "../LICENSE.txt" -t "${FLATPAK_DEST}/share/licenses/rawtherapee/";
modules:
  - gtkmm.yaml
  - lensfun.yaml
  - exiv2.yaml
  - libiptcdata.yaml
  - fftw3f.yaml
  - xmlstarlet.yaml
